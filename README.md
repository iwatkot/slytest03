placeholder for CodeClimate badge

## Overview
The repo contains the script, which extractes clouds of points from scenes in [NuScenes dataset](https://www.nuscenes.org/nuscenes#download).<br>
**Disclaimer**: this script doesn't work correctly, since it's not reading angles of objects. It's just an example of how the same problem can be solved, but the solution is unfinished and will generate incorrect data.<br>
**Note:** the script requires NuScenes mini dataset to be present in the directory where the script will be launched.<br>
The script uses `nuscenes` and `numpy` to work with dataset and `open3d` to write data to the **ply** files. In addition the repo contains a simple logger, which uses Python's built-in logging module, and writes logs both to the file and stdout. The log_handler module is also contains a decorator for measuring the runtime of the functions.<br>

## Get started
_The script is designed to be launched from the command line with arguments._<br><br>
**Example of splitting the image:** `python3 extract_boxes.py --scene_number <>`<br>
Where scene_number is required and should be in range from 0 to 9 (since the mini dataset contains only 10 items).<br>
<br>


## Asciinema examples
**Extracting clouds of points:**<br>
[![asciicast](https://asciinema.org/a/D0OWGLr9EcjMG3FTPg3N1Gz0e.svg)](https://asciinema.org/a/D0OWGLr9EcjMG3FTPg3N1Gz0e)<br>
<br>

## Report
I started solving of this problem with getting familiar with each of dataset examplesm, that was provided in the test task (waymo, nuscenes, kitti3d). I checked how I can download the datasets, what are their sizes and which tools are provided from the developers of the dataset. I decided that NuScenes will provide convenient tools along with easy data download and downloaded the mini version of the dataset.<br>
However, I ran into problems of installing nuscenes for Python because while installing dependencies some errors are occured. I spent some time trying to solve the problem, but it's ended with simple answer from Google: "it's just wont work on Windows". So I "moved" my developing to Linux and successfully installed all neccessary libraries. After that I started to read [NuScenes tutorial](https://www.nuscenes.org/tutorials/nuscenes_tutorial.html) and found out, that the developers of NuScenes did a great job, since it was clear enough how to start working and and most importantly - understand how data is stored in the dataset. I believe that this part of the task took the most time, since I was new into data like this and I was researching it step by step. It took considerable amount of time because before I started to work with this task, I didn't quite understand how lidars work in general, how they store data and calculate coordinates. So it was pretty interesting to know these details.<br>
After I finally understood the structure of the data and how to get needed parts of it, I started the approach with easiest way: we've got a box with it's sizes and center coordinates, and we've got a points, which have the coordinates too. It didn't sound too complex to get all those points. But there was one thing, that I still didn't knew about lidars and how they store object coordinates.<br>
So, at first it was really easy: get all boxes from the dataset and check if the name of the box is the one we need. Then we get the coordinates of center, dimensions and calculating the area of interest. But it's just didn't work. Since I was new into this, I considered that it's something wrong with the mask, that I write or how I unpacked sizes or calculate the area. I didn't check a range of values in the ps array, where coordinates was stored. So I spent some time continiously trying to change the mask, the way how I used coordinates, etc. After I runned out of ideas what can be wrong with my code in algorithm, I finally decided to check the values in the points array. And found out that all this time I was trying to catch the points which was stored as global coordinates, while boxes had relative coordinates.<br>
The understanding of this helped a lot, so I started to look for useful data in the dataset, because I remembered that I read somewhere about those global / relative coordinates, while googling and reading tutorials. And I found file which was containing translation data for each sample. I used this data to convert pc array with points from global to relative (but for some reason I'm still not sure that I did it right) and finally recieved some results. The solution that present in this repo wasn't supposed to be a final, since I used mask just to understand what I'm doing, how coordinates look, etc. I noticed that box objects also has data about angles, so it was obvious that my algorithm won't work, just because it's calculating rectangles without any data about position in space. I was planning to use some functions from nuscenes-devkit for the final solution.<br>
I found that nuscenes-devkit contains `points_in_box()` function, which takes a points array and a Box object and returns exactly what I needed to solve the problem. The Box object was also easy-to-create with the data, that I have: `box = Box(box.center, box.wlh, box.orientation, name=box.name)`. I created and example of this class and pass it into the function, but it turned out that the function expects that Box object contains corner data. But for some reason I didn't manage to create a correct Box object with corner data even the box.corners() function was returning correct corner data. I've tried to manually add corner data to the object, but it didn't helped either. I've checked source code of the function in the NuScenes github repo, but it didn't helped me to understand what's wrong here. Since I had no other options and unserstanding of what and why is going wrong, I decided to stop solving the problem and provided the current solutuion, which doesn't return the correct data, but at least it returns anything.